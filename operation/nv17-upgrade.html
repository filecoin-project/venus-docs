<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nv17 upgrade | Venus Filecoin</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/assets/venus-logo.png">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-SMSDTMGLTV"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SMSDTMGLTV');</script>
    <meta name="description" content="Venus is a Go implementation of the Filecoin Distributed Storage Network.">
    
    <link rel="preload" href="/assets/css/0.styles.117964e0.css" as="style"><link rel="preload" href="/assets/js/app.5e5035a9.js" as="script"><link rel="preload" href="/assets/js/2.d93b85b3.js" as="script"><link rel="preload" href="/assets/js/54.ae93d6fd.js" as="script"><link rel="prefetch" href="/assets/js/10.d1c164f8.js"><link rel="prefetch" href="/assets/js/100.acf12d52.js"><link rel="prefetch" href="/assets/js/101.d6ba60a8.js"><link rel="prefetch" href="/assets/js/102.676d0a56.js"><link rel="prefetch" href="/assets/js/103.1f4cb286.js"><link rel="prefetch" href="/assets/js/104.fd5b6b88.js"><link rel="prefetch" href="/assets/js/105.f1fe94c2.js"><link rel="prefetch" href="/assets/js/106.4e89ca90.js"><link rel="prefetch" href="/assets/js/11.39d382c8.js"><link rel="prefetch" href="/assets/js/12.a8fa267b.js"><link rel="prefetch" href="/assets/js/13.29435311.js"><link rel="prefetch" href="/assets/js/14.01a8da50.js"><link rel="prefetch" href="/assets/js/15.781d84eb.js"><link rel="prefetch" href="/assets/js/16.9090bfde.js"><link rel="prefetch" href="/assets/js/17.3c92535e.js"><link rel="prefetch" href="/assets/js/18.af070300.js"><link rel="prefetch" href="/assets/js/19.cbf85e59.js"><link rel="prefetch" href="/assets/js/20.a02f1659.js"><link rel="prefetch" href="/assets/js/21.0e15d93f.js"><link rel="prefetch" href="/assets/js/22.7e14d97d.js"><link rel="prefetch" href="/assets/js/23.fcddfb27.js"><link rel="prefetch" href="/assets/js/24.7303e4a8.js"><link rel="prefetch" href="/assets/js/25.0a0abec4.js"><link rel="prefetch" href="/assets/js/26.998e88da.js"><link rel="prefetch" href="/assets/js/27.e480a1b5.js"><link rel="prefetch" href="/assets/js/28.e09e0ccc.js"><link rel="prefetch" href="/assets/js/29.28e077d6.js"><link rel="prefetch" href="/assets/js/3.1d3b456e.js"><link rel="prefetch" href="/assets/js/30.def6f408.js"><link rel="prefetch" href="/assets/js/31.fd489160.js"><link rel="prefetch" href="/assets/js/32.d1735f82.js"><link rel="prefetch" href="/assets/js/33.d4a965cd.js"><link rel="prefetch" href="/assets/js/34.fcb328a5.js"><link rel="prefetch" href="/assets/js/35.eaf7f0bf.js"><link rel="prefetch" href="/assets/js/36.cb3f2a10.js"><link rel="prefetch" href="/assets/js/37.e01e5e96.js"><link rel="prefetch" href="/assets/js/38.36059892.js"><link rel="prefetch" href="/assets/js/39.732b1dc4.js"><link rel="prefetch" href="/assets/js/4.f3c6d7d0.js"><link rel="prefetch" href="/assets/js/40.34270f85.js"><link rel="prefetch" href="/assets/js/41.ccdd0cf9.js"><link rel="prefetch" href="/assets/js/42.d1b1ad7f.js"><link rel="prefetch" href="/assets/js/43.73f4037c.js"><link rel="prefetch" href="/assets/js/44.e4bf7a1b.js"><link rel="prefetch" href="/assets/js/45.89899402.js"><link rel="prefetch" href="/assets/js/46.d7da63e0.js"><link rel="prefetch" href="/assets/js/47.0d2ad72c.js"><link rel="prefetch" href="/assets/js/48.e217112a.js"><link rel="prefetch" href="/assets/js/49.b9ded15e.js"><link rel="prefetch" href="/assets/js/5.bd4cdbc7.js"><link rel="prefetch" href="/assets/js/50.50f17b89.js"><link rel="prefetch" href="/assets/js/51.3cccea63.js"><link rel="prefetch" href="/assets/js/52.8424010f.js"><link rel="prefetch" href="/assets/js/53.6b8ce2fa.js"><link rel="prefetch" href="/assets/js/55.8c7849db.js"><link rel="prefetch" href="/assets/js/56.b9f020c1.js"><link rel="prefetch" href="/assets/js/57.88fad549.js"><link rel="prefetch" href="/assets/js/58.6983af66.js"><link rel="prefetch" href="/assets/js/59.8e310c91.js"><link rel="prefetch" href="/assets/js/6.3dd12158.js"><link rel="prefetch" href="/assets/js/60.cc23edcf.js"><link rel="prefetch" href="/assets/js/61.b67b475a.js"><link rel="prefetch" href="/assets/js/62.635b0125.js"><link rel="prefetch" href="/assets/js/63.8271cc70.js"><link rel="prefetch" href="/assets/js/64.745968c7.js"><link rel="prefetch" href="/assets/js/65.46f33d71.js"><link rel="prefetch" href="/assets/js/66.5587bf58.js"><link rel="prefetch" href="/assets/js/67.c6b165ba.js"><link rel="prefetch" href="/assets/js/68.08104a13.js"><link rel="prefetch" href="/assets/js/69.7eb6d599.js"><link rel="prefetch" href="/assets/js/7.a560c27d.js"><link rel="prefetch" href="/assets/js/70.8c2c62f9.js"><link rel="prefetch" href="/assets/js/71.33cf82be.js"><link rel="prefetch" href="/assets/js/72.bb6dfe8b.js"><link rel="prefetch" href="/assets/js/73.cc8e9bc1.js"><link rel="prefetch" href="/assets/js/74.d29bf8c7.js"><link rel="prefetch" href="/assets/js/75.5adf7b9a.js"><link rel="prefetch" href="/assets/js/76.1440a115.js"><link rel="prefetch" href="/assets/js/77.5d1a8df6.js"><link rel="prefetch" href="/assets/js/78.fd55fa3b.js"><link rel="prefetch" href="/assets/js/79.abfeaec6.js"><link rel="prefetch" href="/assets/js/8.22a211b8.js"><link rel="prefetch" href="/assets/js/80.d1028106.js"><link rel="prefetch" href="/assets/js/81.ea3d49d0.js"><link rel="prefetch" href="/assets/js/82.b26a0568.js"><link rel="prefetch" href="/assets/js/83.55d7eeda.js"><link rel="prefetch" href="/assets/js/84.dbb27105.js"><link rel="prefetch" href="/assets/js/85.5ba85bfc.js"><link rel="prefetch" href="/assets/js/86.5200a8e5.js"><link rel="prefetch" href="/assets/js/87.4a038c01.js"><link rel="prefetch" href="/assets/js/88.ab6b3465.js"><link rel="prefetch" href="/assets/js/89.5f10a5ee.js"><link rel="prefetch" href="/assets/js/9.ffdad4b1.js"><link rel="prefetch" href="/assets/js/90.aeaf36c5.js"><link rel="prefetch" href="/assets/js/91.d497ec61.js"><link rel="prefetch" href="/assets/js/92.8f2ef6aa.js"><link rel="prefetch" href="/assets/js/93.65f9d1d3.js"><link rel="prefetch" href="/assets/js/94.bc8a612b.js"><link rel="prefetch" href="/assets/js/95.c6f4c73e.js"><link rel="prefetch" href="/assets/js/96.2d391d6e.js"><link rel="prefetch" href="/assets/js/97.a729d39e.js"><link rel="prefetch" href="/assets/js/98.4b6ee74b.js"><link rel="prefetch" href="/assets/js/99.d08e8cdd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.117964e0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/venus-logo-title.svg" alt="Venus Filecoin" class="logo"> <span class="site-name can-hide">Venus Filecoin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/intro/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/operation/" class="nav-link router-link-active">
  Operation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/operation/nv17-upgrade.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/operation/nv17-upgrade.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/intro/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/operation/" class="nav-link router-link-active">
  Operation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/operation/nv17-upgrade.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/operation/nv17-upgrade.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Operation</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/operation/" aria-current="page" class="sidebar-link">High Availability Solution</a></li><li><a href="/operation/example-single-box.html" class="sidebar-link">Example single box setup (depreciating)</a></li><li><a href="/operation/Efficiency_of_sealing.html" class="sidebar-link">Finding optimal configurations</a></li><li><a href="/operation/System_monitor_of_Zabbix.html" class="sidebar-link">System monitoring (Zabbix)</a></li><li><a href="/operation/lotus-vs-venus.html" class="sidebar-link">Configurations inherited from Lotus</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Upgrade</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/operation/nv17-upgrade.html" aria-current="page" class="active sidebar-link">nv17 upgrade</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/operation/nv16-upgrade.html" class="sidebar-link">nv16 upgrade</a></li><li><a href="/operation/nv15-upgrade.html" class="sidebar-link">nv15 upgrade</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nv17-upgrade"><a href="#nv17-upgrade" class="header-anchor">#</a> nv17 upgrade</h1> <p>If you are upgrading <code>venus-wallet</code> or <code>venus-gateway</code> from <code>v1.6.x</code> to <code>v1.8.0</code>, please read <a href="https://github.com/filecoin-project/venus/discussions/5265" target="_blank" rel="noopener noreferrer">Venus component v1.7.0 usage notes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> first and pay attention to the upgrade order of <code>venus-gateway</code> and <code>venus-wallet</code>.</p> <h3 id="timeline"><a href="#timeline" class="header-anchor">#</a> timeline</h3> <p>Upgrade time (UTC): 2022-11-30T14:00:00Z
Upgrade time (Beijing): 2022-11-30 22:00:00</p> <h3 id="versions-of-each-component"><a href="#versions-of-each-component" class="header-anchor">#</a> Versions of each component</h3> <ul><li><a href="https://github.com/filecoin-project/venus/discussions/5386#discussioncomment-3893446" target="_blank" rel="noopener noreferrer">calibrationnet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/filecoin-project/venus/discussions/5386#discussioncomment-3893449" target="_blank" rel="noopener noreferrer">mainnet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="venus-auth"><a href="#venus-auth" class="header-anchor">#</a> venus-auth</h3> <p>Affected function:</p> <p>Dependency: none</p> <p>Precautions:</p> <ol><li>Add field <code>open_mining</code> to <code>miners</code> table, 0 means no block, 1 means block, default is 1</li></ol> <h3 id="venus"><a href="#venus" class="header-anchor">#</a> venus</h3> <p>Affected function: nv17 network support</p> <p>Dependency: None</p> <p>Precautions:</p> <p>Compilation: first <code>make dist-clean</code> and then <code>make</code>, this can prevent problems caused by failing to upgrade <code>filecoin-ffi</code>.</p> <ol><li><p>Check whether the vk file is complete after upgrading</p></li> <li><p>Check the configuration file after the upgrade, whether the upgrade height is set correctly, the configuration file is in <code>~/.venus/config.json</code> by default:</p> <div class="language- extra-class"><pre class="language-text"><code>#cali
&quot;upgradeSkyrHeight&quot;: 16800
#mainnet
&quot;upgradeSkyrHeight&quot;: 2383680
</code></pre></div></li> <li><p>After the upgrade, you need to check whether height is synchronized correctly</p></li> <li><p>Check the mainnet <code>v9 actors code</code> to make sure it is the same as the output below</p> <div class="language- extra-class"><pre class="language-text"><code>./venus state actor-cids --network-version 17

# order may vary
Network Version: 17
Actor Version: 9
Actor CIDs
reward bafk2bzacebezgbbmcm2gbcqwisus5fjvpj7hhmu5ubd37phuku3hmkfulxm2o
system bafk2bzaceagvlo2jtahj7dloshrmwfulrd6e2izqev32qm46eumf754weec6c
_manifest bafy2bzaceb6j6666h36xnhksu3ww4kxb6e25niayfgkdnifaqi6m6ooc66i6i
storagemarket bafk2bzacec3j7p6gklk64stax5px3xxd7hdtejaepnd4nw7s2adihde6emkcu
multisig bafk2bzacec4va3nmugyqjqrs3lqyr2ij67jhjia5frvx7omnh2isha6abxzya
paymentchannel bafk2bzacebhdvjbjcgupklddfavzef4e4gnkt3xk3rbmgfmk7xhecszhfxeds
storagepower bafk2bzacedsetphfajgne4qy3vdrpyd6ekcmtfs2zkjut4r34cvnuoqemdrtw
verifiedregistry bafk2bzacecf3yodlyudzukumehbuabgqljyhjt5ifiv4vetcfohnvsxzynwga
datacap bafk2bzacebb6uy2ys7tapekmtj7apnjg7oyj4ia5t7tlkvbmwtxwv74lb2pug
account bafk2bzacect2p7urje3pylrrrjy3tngn6yaih4gtzauuatf2jllk3ksgfiw2y
cron bafk2bzacebcec3lffmos3nawm5cvwehssxeqwxixoyyfvejy7viszzsxzyu26
init bafk2bzacebtdq4zyuxk2fzbdkva6kc4mx75mkbfmldplfntayhbl5wkqou33i
storageminer bafk2bzacedyux5hlrildwutvvjdcsvjtwsoc5xnqdjl73ouiukgklekeuyfl4
</code></pre></div></li> <li><p>If you are not troubleshooting anything, it is <strong>NOT</strong> recommended to set rust log level to <code>trace</code> as more irrelavant logs will be printed</p></li> <li><p>After the upgrade, you can use the command <code>./venus state get-actor t01000</code> to confirm whether the upgrade is successful</p></li></ol> <h3 id="venus-messager"><a href="#venus-messager" class="header-anchor">#</a> venus-messager</h3> <p>Affected function:</p> <ol><li>Increase the control of basefee, you can set the basefee separately for an address, when the basefee on the chain is higher than the basefee limit, the message will not be pushed out</li></ol> <p>Dependency upgrade components:</p> <p>Precautions:</p> <ol><li>After the upgrade, observe whether the message can be on-chained normally</li></ol> <h3 id="venus-miner"><a href="#venus-miner" class="header-anchor">#</a> venus-miner</h3> <p>Affected function:</p> <p>Dependency upgrade components:</p> <p>Precautions:</p> <ol><li><p>If you are upgrading from <code>1.7.*</code> to <code>v1.8.0</code>, it will automatically migrate configuration files. Whereas if you are upgrading from <code>1.6.*</code> to <code>v1.8.0</code>, it is required to have a reinitialization of <code>repo</code> (init). Please checkout this <a href="https://github.com/filecoin-project/venus-miner/blob/master/docs/zh/CHANGELOG.md#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2" target="_blank" rel="noopener noreferrer">guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to learn more.</p></li> <li><p>Check if blocks can be produced normally after the upgrade.</p></li></ol> <h3 id="venus-gateway"><a href="#venus-gateway" class="header-anchor">#</a> venus-gateway</h3> <p>Affected function:</p> <p>Precautions:</p> <p>Compile: first <code>make dist-clean</code> and then <code>make</code></p> <ol><li>Check wallet after upgrade: <code>./venus-gateway wallet list</code></li> <li>Check miners after upgrade: <code>./venus-gateway miner list</code></li></ol> <h3 id="venus-market"><a href="#venus-market" class="header-anchor">#</a> venus-market</h3> <p>Affected function:</p> <p>Precautions:</p> <p>Compile: first <code>make dist-clean</code> and then <code>make</code></p> <h3 id="venus-wallet"><a href="#venus-wallet" class="header-anchor">#</a> venus-wallet</h3> <p>Affect function:</p> <p>Precautions:</p> <ol><li>Make sure to unlock the wallet after startup</li> <li>Check whether the wallet is registered on the gateway</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/filecoin-project/venus-docs/edit/master/docs/operation/nv17-upgrade.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/22/2023, 2:32:00 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/operation/lotus-vs-venus.html" class="prev">
        Configurations inherited from Lotus
      </a></span> <span class="next"><a href="/operation/nv16-upgrade.html">
        nv16 upgrade
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.5e5035a9.js" defer></script><script src="/assets/js/2.d93b85b3.js" defer></script><script src="/assets/js/54.ae93d6fd.js" defer></script>
  </body>
</html>
