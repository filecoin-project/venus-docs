(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{412:function(t,n,a){"use strict";a.r(n);var s=a(17),e=Object(s.a)({},(function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("For a more complex chain service, please refer to "),a("RouterLink",{attrs:{to:"/operation/"}},[t._v("this document")]),t._v(" for a full scale HA solution.")],1)]),t._v(" "),a("h2",{attrs:{id:"preparation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preparation"}},[t._v("#")]),t._v(" Preparation")]),t._v(" "),a("ol",[a("li",[t._v("Cancel the jwt-token verification of Venus program;")]),t._v(" "),a("li",[t._v("This example has two Venus nodes: 192.168.1.125 (mainnet) and 192.168.1.134 (calibnet);")]),t._v(" "),a("li",[t._v("192.168.1.134 install nginx as the load balancing server;")])]),t._v(" "),a("h2",{attrs:{id:"configure-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-nginx"}},[t._v("#")]),t._v(" Configure nginx")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("The monitoring address of Venus node is changed to / ip4 / 0.0.0.0/tcp/3453, file: ~ /. venus / api")])]),t._v(" "),a("li",[a("p",[t._v("Configure load balancing")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\nhttp\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\nserver\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("888")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server_name phpmyadmin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index index.html index.htm index.php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        root  /www/server/phpmyadmin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#error_page   404   /404.html;")]),t._v("\n        include enable-php.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n        location /\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            proxy_pass http://venussvr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        access_log  /www/wwwlogs/access.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nupstream venussvr\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.125:3453 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.134:3453 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ninclude /www/server/panel/vhost/nginx/*.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Restart the nginx service. You can use nginx service to proxy venus service")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('# curl http://192.168.1.134:888/rpc/v0 -X POST -H "Content-Type: application/json"  -d \'{"method": "Filecoin.StateNetworkName","params":[],"id":1}\'\n{"jsonrpc":"2.0","result":"mainnet","id":1}\n# curl http://192.168.1.134:888/rpc/v0 -X POST -H "Content-Type: application/json"  -d \'{"method": "Filecoin.StateNetworkName","params":[],"id":1}\'\n{"jsonrpc":"2.0","result":"calibrationnet","id":1}\n')])])])])])])}),[],!1,null,null,null);n.default=e.exports}}]);