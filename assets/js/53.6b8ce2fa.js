(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{428:function(e,t,a){"use strict";a.r(t);var n=a(17),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"nv16-upgrade"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nv16-upgrade"}},[e._v("#")]),e._v(" nv16 upgrade")]),e._v(" "),a("h3",{attrs:{id:"timeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timeline"}},[e._v("#")]),e._v(" timeline")]),e._v(" "),a("p",[e._v("Mainnet upgrade time: 2022-07-06T14:00:00Z")]),e._v(" "),a("h3",{attrs:{id:"venus-auth"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-auth"}},[e._v("#")]),e._v(" venus-auth")]),e._v(" "),a("ul",[a("li",[e._v("tag: v1.6.0")]),e._v(" "),a("li",[e._v("New features: shared token access support for multi SPs")]),e._v(" "),a("li",[e._v("Dependency on other components: none")])]),e._v(" "),a("p",[e._v("Things to look out for:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Add a "),a("code",[e._v("miners")]),e._v(" table to save the correspondence between "),a("code",[e._v("user")]),e._v(" and "),a("code",[e._v("miner")])])]),e._v(" "),a("li",[a("p",[e._v("Write the values ​​of the "),a("code",[e._v("name")]),e._v(" and "),a("code",[e._v("miner")]),e._v(" fields of each row of data in the "),a("code",[e._v("users")]),e._v(" table to the "),a("code",[e._v("user")]),e._v(" and "),a("code",[e._v("miner")]),e._v(" fields in the "),a("code",[e._v("miners")]),e._v(" table, check whether there is any problem with the writing, the success log: "),a("code",[e._v("migrate from:0, to:1 success;")]),e._v(" failure log: "),a("code",[e._v("migrate from store version:0 failed")])])]),e._v(" "),a("li",[a("p",[e._v("Use "),a("code",[e._v("./venus-auth user miner list <user>")]),e._v(" to list all miners binded to "),a("code",[e._v("user")])])]),e._v(" "),a("li",[a("p",[e._v("Use the command "),a("code",[e._v("./venus-auth user list")]),e._v(" to list all users. "),a("strong",[e._v("Note: make sure that the status of the user being used is enabled")])])])]),e._v(" "),a("h3",{attrs:{id:"venus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus"}},[e._v("#")]),e._v(" venus")]),e._v(" "),a("ul",[a("li",[e._v("tag: v1.6.0")]),e._v(" "),a("li",[e._v("New features: Support for nv16 networks")]),e._v(" "),a("li",[e._v("Dependency on other components: none")])]),e._v(" "),a("p",[e._v("Things to look out for:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Check whether the vk file is complete after the upgrade")])]),e._v(" "),a("li",[a("p",[e._v("Check the configuration file after the upgrade to see if the upgrade height is properly set. The default configuration file is in "),a("code",[e._v("~/.venus/config.json")]),e._v(" :")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# cali\n"upgradeSkyrHeight": 1044660\n#mainnet\n"upgradeSkyrHeight": 1960320\n')])])])]),e._v(" "),a("li",[a("p",[e._v("After the upgrade, check whether the blocks are properly synchronized")])]),e._v(" "),a("li",[a("p",[e._v("The api version has changed, affecting the miner connection")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# Use the curl command to test the interfaces StateGetBeaconEntry, BeaconGetEntry, the following three curl commands should return the same results\ncurl http://127.0.0.1:3453/rpc/v0 -X POST -H "Content-Type: application/json" -H "Authorization: Bearer token" -d \'{"method": "Filecoin.BeaconGetEntry", "params":[1933610], "id": 0}\'\ncurl http://127.0.0.1:3453/rpc/v1 -X POST -H "Content-Type: application/json" -H "Authorization: Bearer token" -d \'{"method": "Filecoin.BeaconGetEntry", "params":[1933610], "id": 0}\'\ncurl http://127.0.0.1:3453/rpc/v1 -X POST -H "Content-Type: application/json" -H "Authorization: Bearer token" -d \'{"method": "Filecoin.StateGetBeaconEntry", "params":[1933610], "id": 0}\'\n')])])])]),e._v(" "),a("li",[a("p",[e._v("Check the mainnet v8 actors cid and make sure it is the same as the output below")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("./venus state actor-cids\n\n# The order may vary\n_manifest bafy2bzacebogjbpiemi7npzxchgcjjki3tfxon4ims55obfyfleqntteljsea\naccount bafk2bzacedudbf7fc5va57t3tmo63snmt3en4iaidv4vo3qlyacbxaa6hlx6y\nstoragemarket bafk2bzacediohrxkp2fbsl4yj4jlupjdkgsiwqb4zuezvinhdo2j5hrxco62q\nstorageminer bafk2bzacecgnynvd3tene3bvqoknuspit56canij5bpra6wl4mrq2mxxwriyu\nmultisig bafk2bzacebhldfjuy4o5v7amrhp5p2gzv2qo5275jut4adnbyp56fxkwy5fag\npaymentchannel bafk2bzacebalad3f72wyk7qyilvfjijcwubdspytnyzlrhvn73254gqis44rq\nreward bafk2bzacecwzzxlgjiavnc3545cqqil3cmq4hgpvfp2crguxy2pl5ybusfsbe\nsystem bafk2bzacedwq5uppsw7vp55zpj7jdieizirmldceehu6wvombw3ixq2tcq57w\ncron bafk2bzacecqb3eolfurehny6yp7tgmapib4ocazo5ilkopjce2c7wc2bcec62\ninit bafk2bzaceaipvjhoxmtofsnv3aj6gj5ida4afdrxa4ewku2hfipdlxpaektlw\nstoragepower bafk2bzacebjvqva6ppvysn5xpmiqcdfelwbbcxmghx5ww6hr37cgred6dyrpm\nverifiedregistry bafk2bzaceb3zbkjz3auizmoln2unmxep7dyfcmsre64vnqfhdyh7rkqfoxlw4\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Mainnet can use fvm on nv15 network by setting environment variable "),a("code",[e._v("export VENUS_USE_FVM_TO_SYNC_MAINNET_V15=1")])])]),e._v(" "),a("li",[a("p",[e._v("If you do not troubleshoot the problem, the rust log level is "),a("strong",[e._v("not recommended")]),e._v(" to be set to "),a("code",[e._v("trace")]),e._v(", because more logs will be printed")])]),e._v(" "),a("li",[a("p",[e._v("After the upgrade, you can use the command "),a("code",[e._v("./venus state get-actor t01000")]),e._v(" to confirm whether the upgrade is successful")])])]),e._v(" "),a("h3",{attrs:{id:"venus-messager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-messager"}},[e._v("#")]),e._v(" venus-messager")]),e._v(" "),a("ul",[a("li",[e._v("tag:v1.6.0")]),e._v(" "),a("li",[e._v("Affected function: Support new network version, add home directory, default in "),a("code",[e._v("~/.venus-messager")])]),e._v(" "),a("li",[e._v("Dependency on other components: none")])]),e._v(" "),a("p",[e._v("Things to look out for:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Whether to generate the main directory "),a("code",[e._v("~/.venus-messager")]),e._v(" after the upgrade")])]),e._v(" "),a("li",[a("p",[e._v("After the upgrade, the main directory should contain "),a("code",[e._v("config.toml")]),e._v(" and "),a("code",[e._v("tipset.json")]),e._v(", "),a("code",[e._v("config.toml")]),e._v(" should be consistent with the configuration file used to start "),a("code",[e._v("messager")]),e._v(", "),a("code",[e._v("~/.venus-messager/tipset.json")]),e._v(" is copied from "),a("code",[e._v("tipset.json")]),e._v(" in the current directory")])]),e._v(" "),a("li",[a("p",[e._v("After the upgrade is successful, restarting again is to read the configuration is "),a("code",[e._v("~/.venus-messager/config.toml")])])]),e._v(" "),a("li",[a("p",[e._v("Whether the message can be received and pushed to the node normally")])])]),e._v(" "),a("h3",{attrs:{id:"venus-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-miner"}},[e._v("#")]),e._v(" venus-miner")]),e._v(" "),a("ul",[a("li",[e._v("tag: v1.6.0")]),e._v(" "),a("li",[e._v("New features: Get the interface name of beacon Change from "),a("code",[e._v("BeaconGetEntry")]),e._v(" to "),a("code",[e._v("StateGetBeaconEntry")])]),e._v(" "),a("li",[e._v("Dependency on other components: venus, venus-auth, venus-gateway")])]),e._v(" "),a("p",[e._v("Things to look out for:")]),e._v(" "),a("ol",[a("li",[e._v("After the upgrade, use the commonly used command address state/list/update to verify it.")]),e._v(" "),a("li",[e._v("If you use a mysql database, check that the parent_key field in the miner_blocks table is varchar(1000)")])]),e._v(" "),a("h3",{attrs:{id:"venus-gateway"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-gateway"}},[e._v("#")]),e._v(" venus-gateway")]),e._v(" "),a("ul",[a("li",[e._v("tag: v1.6.0")]),e._v(" "),a("li",[e._v("New Feature: Fix requests without auto cleanup timeouts")])]),e._v(" "),a("p",[e._v("Things to look out for:")]),e._v(" "),a("ol",[a("li",[e._v("Is "),a("code",[e._v("wallet")]),e._v(" re-registered after the upgrade")])]),e._v(" "),a("h3",{attrs:{id:"venus-market"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-market"}},[e._v("#")]),e._v(" venus-market")]),e._v(" "),a("ul",[a("li",[e._v("tag: v2.2.0")]),e._v(" "),a("li",[e._v("New features:")])]),e._v(" "),a("p",[e._v("Things to look out for::")]),e._v(" "),a("h3",{attrs:{id:"venus-wallet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-wallet"}},[e._v("#")]),e._v(" venus-wallet")]),e._v(" "),a("h4",{attrs:{id:"community"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#community"}},[e._v("#")]),e._v(" Community")]),e._v(" "),a("ul",[a("li",[e._v("tag: v1.6.0")]),e._v(" "),a("li",[e._v("New features:")])]),e._v(" "),a("p",[e._v("Things to look out for::")]),e._v(" "),a("ol",[a("li",[e._v("Need to unlock wallet")]),e._v(" "),a("li",[e._v("if wallet is properly registered on the gateway")])])])}),[],!1,null,null,null);t.default=s.exports}}]);