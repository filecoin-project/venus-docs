(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{423:function(t,s,e){"use strict";e.r(s);var a=e(17),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h3",{attrs:{id:"exit-guide"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exit-guide"}},[t._v("#")]),t._v(" Exit Guide")]),t._v(" "),e("p",[t._v("There are couple options for storage providers to exit a hosted chain service either voluntarily or after each phase ends.")]),t._v(" "),e("ul",[e("li",[t._v("Join a hosted chain service (venus shared modules) by third party.")]),t._v(" "),e("li",[t._v("Deploy a chain service (venus shared modules) by yourself.")]),t._v(" "),e("li",[t._v("Switch back to Lotus.")])]),t._v(" "),e("p",[t._v("We will go through option 2 and 3 in this documentation.")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Make sure you go through the documentation carefully before carry out the exit. Find us on Slack if you have questions.")])]),t._v(" "),e("h3",{attrs:{id:"deploy-a-chain-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-a-chain-service"}},[t._v("#")]),t._v(" Deploy a chain service")]),t._v(" "),e("p",[t._v("Refer to this "),e("a",{attrs:{href:"https://venus.filecoin.io/guide/How-To-Deploy-MingPool.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("document"),e("OutboundLink")],1),t._v(" to first deploy your own venus chain service. Modify configuration file ("),e("code",[t._v("~/.venus_wallet/config.toml")]),t._v(") of "),e("code",[t._v("venus-wallet")]),t._v(" to point to the newly deployed chain service.")]),t._v(" "),e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("APIRegisterHub")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("RegisterAPI")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/<IP_ADDRESS_OF_VENUS_GATEWAY>/tcp/45132"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<AUTH_TOKEN_FOR_ACCOUNT_NAME>"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("SupportAccounts")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<ACCOUNT_NAME>"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("p",[t._v("Modify the configuration file of  "),e("code",[t._v("venus-sealer")]),t._v(" ("),e("code",[t._v("~/.venussealer/config.toml")]),t._v(") to point to the newly deployed chain service.")]),t._v(" "),e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Node")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/<IP_ADDRESS_OF_VENUS>/tcp/3453"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" <AUTH_TOKEN_FOR_ACCOUNT_NAME>\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("JWT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Secret")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8e5e90ad4c6ce64e16f4bd20622ad60b9b236caefb97081f09b53acfa75e6a44"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Messager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" /ip4/<IP_ADDRESS_OF_VENUS_MESSAGER>/tcp/<PORT_OF_VENUS_MESSAGER>\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" <AUTH_TOKEN_FOR_ACCOUNT_NAME>\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("RegisterProof")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Urls")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/<IP_ADDRESS_OF_VENUS_GATEWAY>/tcp/<PORT_OF_VENUS_GATEWAY>"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" <AUTH_TOKEN_FOR_ACCOUNT_NAME>\n")])])]),e("p",[t._v("Restart "),e("code",[t._v("venus-walle")]),t._v(" and "),e("code",[t._v("venus-sealer")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"switch-back-to-lotus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#switch-back-to-lotus"}},[t._v("#")]),t._v(" Switch back to lotus")]),t._v(" "),e("p",[t._v("Refer to Lotus "),e("a",{attrs:{href:"https://docs.filecoin.io/mine/lotus/#protocol-labs-example-architecture",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation"),e("OutboundLink")],1),t._v(" to build and deploy a Lotus node. Sync the node from a snapshot.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./lotus daemon --import-snapshot"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" lotus.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),e("p",[t._v("Import addresses under your miner_id (eg. owner, worker, controller addresses and etc.) into lotus;")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# export private key from venus-wallet")]),t._v("\n$ ./venus-wallet "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("WALLET_ADDRESS"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nPassword:\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# import them to lotus")]),t._v("\n$  ./lotus wallet "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v("\nEnter private key: \n")])])]),e("p",[t._v("Make sure you have no sealing tasks running, messages properly sent on-chain and enough time before your next windowPost deadline. Then stop venus-sealer and initialize a new repo using lotus-miner.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TRUST_PARAMS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" ./lotus-miner init --no-local-storage --actor"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("minerID"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" --sector-size"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("32G --nosync\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Note that lotus-miner repo must not have the same path as the repo of venus-sealer.")])]),t._v(" "),e("p",[t._v("Build lotus-fix utility tool, set nextid and import sectors from venus-sealer.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Skip if you already compiled ffi")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" submodule update --init --recursive\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Compile lotus-fix")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" lotus-fix\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fix nextid and import sectors from venus-sealer")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# change repo path accordingly")]),t._v("\n$ ./lotus-fix -lotus-miner-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.lotusminer/ -venus-sealer-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.venussealer -taskType"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("lotus-fix is a utility tool for migrating from venus to lotus.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# taskType=0; manually change nextid")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set nextid to 300 with -sid flag")]),t._v("\n$ ./lotus-fix -lotus-miner-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.lotusminer/ -venus-sealer-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.venussealer -taskType"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" -sid"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# taskType=1; import sectors from venus-sealer to lotus-miner")]),t._v("\n$ ./lotus-fix -lotus-miner-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.lotusminer/ -venus-sealer-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.venussealer -taskType"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# taskType=2; atuo change nextid and import sectors from venus-sealer to lotus-miner ")]),t._v("\n$ ./lotus-fix -lotus-miner-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.lotusminer/ -venus-sealer-repo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/.venussealer -taskType"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Make sure lotus-miner is not running while using lotus-fix.")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("If executing lotus-fix from root user while lotus-miner is run by a user account, you may need set the following.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For example, if your user account name is `test`")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" test:test /home/test/ -R\n")])])])]),t._v(" "),e("p",[t._v("Attach "),e("code",[t._v("store path")]),t._v(" to lotus-miner, which should be the same as the store path of venus-sealer.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# do not add the `--init` flag")]),t._v("\n./lotus-miner storage attach --store "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_SEALER_STORE_PATH"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("p",[t._v("Pledge a new sector")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# attach seal path for lotus-miner")]),t._v("\n$ ./lotus-miner storage attach --init --seal "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./lotus-miner run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" miner.log "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n$ ./lotus-miner sectors pledge\n")])])]),e("p",[t._v("At this point, your storage system has been switched to lotus. For follow-up operations, please refer to lotus related documents.")])])}),[],!1,null,null,null);s.default=n.exports}}]);