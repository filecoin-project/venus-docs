(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{393:function(t,a,s){"use strict";s.r(a);var e=s(17),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"frontmatter-title"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#frontmatter-title"}},[t._v("#")]),t._v(" "+t._s(t.$frontmatter.title))]),t._v(" "),s("p",[t._v(t._s(t.$frontmatter.description)+".")]),t._v(" "),s("h2",{attrs:{id:"syncing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syncing"}},[t._v("#")]),t._v(" Syncing")]),t._v(" "),s("p",[t._v("Venus will automatically sync to the latest "),s("em",[t._v("chain head")]),t._v(" by:")]),t._v(" "),s("ul",[s("li",[t._v("Fetching the block headers from the current "),s("em",[t._v("head")]),t._v(" down to the last synced epoch.")]),t._v(" "),s("li",[t._v("Retrieving and verifying all the blocks from the last synced epoch to the current head.")])]),t._v(" "),s("p",[t._v("Once Venus is synced, it will learn about new blocks as they are mined for every epoch via Pubsub, and verify them accordingly. Note that in Venus, every epoch might see a variable number of mined blocks.")]),t._v(" "),s("p",[t._v("Filecoin's blockchain grows relatively fast, so a full sync will take long time. For this reason, Venus offers a faster way to sync via trusted state snapshots.")]),t._v(" "),s("h3",{attrs:{id:"syncing-from-a-trusted-state-snapshot-mainnet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syncing-from-a-trusted-state-snapshot-mainnet"}},[t._v("#")]),t._v(" Syncing from a trusted state snapshot (mainnet)")]),t._v(" "),s("p",[t._v("We recommend most users to perform the initial node sync from a minimal, lightweight snapshot. Trusted state snapshots do not contain the full chain and might not be suitable for nodes that need to perform queries against historical state information, like block explorers, but otherwise work for most users.")]),t._v(" "),s("p",[t._v("A recent minimal trusted state chain snapshot is available "),s("a",{attrs:{href:"https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(". We can instruct venus to start the daemon and directly import from the URL:")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The snapshot size is about 7GiB. This works for mainnet.")]),t._v("\nvenus daemon --import-snapshot https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# An alternative is to download first and use the file")]),t._v("\nvenus daemon --import-snapshot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("filename.car"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The sha256sum is stored alongside the interim snapshot and can be obtained via")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sI https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" perl -ne "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^x-amz-website-redirect-location:(.+)\\.car\\s*$/ && print \""),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(".sha256sum\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -s\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("If you do not trust the source of the snapshot or simply want Venus to validate the chain, you need to follow the steps in the next section. Complete validation of the chain is an order of magnitude slower, and is expected to take multiple days.")])]),t._v(" "),s("h3",{attrs:{id:"checking-sync-status"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checking-sync-status"}},[t._v("#")]),t._v(" Checking sync status")]),t._v(" "),s("p",[t._v("There are two ways to track whether the Venus daemon is correctly syncing the chain and how far it has yet to go to complete the syncing:")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Inspect the current sync status, sync workers etc:")]),t._v("\nvenus "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),t._v(" status\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# View the Timestamp of the chain head compared with the current time:")]),t._v("\nvenus chain "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("head")]),t._v("\n")])])]),s("h2",{attrs:{id:"compacting-the-chain-data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compacting-the-chain-data"}},[t._v("#")]),t._v(" Compacting the chain data")]),t._v(" "),s("p",[t._v("It is possible to "),s("em",[t._v("prune")]),t._v(" the current chain data used by Venus to reduce the disk footprint of a Venus node by resyncing from a minimal snapshot.")]),t._v(" "),s("ol",[s("li",[t._v("Stop the Venus daemon:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("venus daemon stop\n")])])]),s("ol",[s("li",[t._v("Remove the contents of the "),s("code",[t._v("badger/")]),t._v(" folder in the Venus path:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf ~/.venus/badger/*\n")])])]),s("ol",[s("li",[t._v("Start the daemon using a minimal snapshot, as explained above:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("venus daemon --import-snapshot https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);