(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{416:function(e,a,t){"use strict";t.r(a);var s=t(17),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"nv18-upgrade-guide"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nv18-upgrade-guide"}},[e._v("#")]),e._v(" nv18 Upgrade Guide")]),e._v(" "),t("p",[e._v("If you are upgrading chain service components from "),t("code",[e._v("v1.8.x")]),e._v(" to "),t("code",[e._v("v1.10.0")]),e._v(", please read "),t("a",{attrs:{href:"https://github.com/filecoin-project/venus/discussions/5531",target:"_blank",rel:"noopener noreferrer"}},[e._v("venus chain-service v1.9.* & venus-market v2.5.* upgrade list / 链服务 v1.9.*和订单服务 v2.5.*升级清单"),t("OutboundLink")],1),e._v(" first and pay special attention to the upgrade of "),t("code",[e._v("venus-auth")]),e._v(" and "),t("code",[e._v("venus-market")]),e._v(". Before upgrading "),t("code",[e._v("venus-auth")]),e._v(", a user account needs to be created for each miner. Also startup CLI and configurations of "),t("code",[e._v("venus-market")]),e._v(" major breaking changes made to it.")]),e._v(" "),t("h2",{attrs:{id:"about-nv18-upgrade"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#about-nv18-upgrade"}},[e._v("#")]),e._v(" About nv18 upgrade")]),e._v(" "),t("p",[e._v("We storngly encourage you to test out the upgrade in calibration before mainnet.")]),e._v(" "),t("h3",{attrs:{id:"upgrade-timeline"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#upgrade-timeline"}},[e._v("#")]),e._v(" Upgrade Timeline")]),e._v(" "),t("p",[e._v("Upgrade UTC time: 2023-03-14T15:14:00Z, which is 2023-03-14 23:14:00 in Beijing time")]),e._v(" "),t("h3",{attrs:{id:"nv18-compatible-versions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nv18-compatible-versions"}},[e._v("#")]),e._v(" nv18 compatible versions")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/filecoin-project/venus/discussions/5649#discussioncomment-4652920",target:"_blank",rel:"noopener noreferrer"}},[e._v("calibrationnet"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/filecoin-project/venus/discussions/5649#discussioncomment-4652933",target:"_blank",rel:"noopener noreferrer"}},[e._v("mainnet"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"venus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus"}},[e._v("#")]),e._v(" venus")]),e._v(" "),t("p",[e._v("Feature: support nv18 network")]),e._v(" "),t("p",[e._v("Dependency: None")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Compile: make sure to first "),t("code",[e._v("make dist-clean")]),e._v(" and then "),t("code",[e._v("make")]),e._v(". This can prevent problems caused by failing to upgrade "),t("code",[e._v("filecoin-ffi")]),e._v(" normally")])]),e._v(" "),t("li",[t("p",[e._v("Check whether the vk file is complete after upgrading")])]),e._v(" "),t("li",[t("p",[e._v("After upgrading, check the configuration file. And see whether "),t("code",[e._v("AllowableClockDriftSecs")]),e._v(", "),t("code",[e._v("UpgradeHyggeHeight")]),e._v(" and "),t("code",[e._v("UpgradeHyggeHeight")]),e._v(" are normal in the log:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("#cali\nAllowableClockDriftSecs: 1\nEip155ChainID:314159\nUpgradeHyggeHeight: 322354\n#mainnet\nAllowableClockDriftSecs: 1\nEip155ChainID:314\nUpgradeHyggeHeight: 2683348\n")])])])]),e._v(" "),t("li",[t("p",[e._v("After upgrading, check the status of block synchronization")])]),e._v(" "),t("li",[t("p",[e._v("Check the mainnet v10 actors CID and make sure it is the same as the output below...")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("./venus state actor-cids --network-version 18\n\n# order may vary\nNetwork Version: 18\nActor Version: 10\nActor CIDs\ndatacap bafk2bzacealj5uk7wixhvk7l5tnredtelralwnceafqq34nb2lbylhtuyo64u\nevm bafk2bzaceahmzdxhqsm7cu2mexusjp6frm7r4kdesvti3etv5evfqboos2j4g\ninit bafk2bzaced2f5rhir3hbpqbz5ght7ohv2kgj42g5ykxrypuo2opxsup3ykwl6\naccount bafk2bzaceampw4romta75hyz5p4cqriypmpbgnkxncgxgqn6zptv5lsp2w2bo\nethaccount bafk2bzaceaqoc5zakbhjxn3jljc4lxnthllzunhdor7sxhwgmskvc6drqc3fa\nmultisig bafk2bzaceduf3hayh63jnl4z2knxv7cnrdenoubni22fxersc4octlwpxpmy4\npaymentchannel bafk2bzaceartlg4mrbwgzcwric6mtvyawpbgx2xclo2vj27nna57nxynf3pgc\nreward bafk2bzacebnhtaejfjtzymyfmbdrfmo7vgj3zsof6zlucbmkhrvcuotw5dxpq\nstoragemarket bafk2bzaceclejwjtpu2dhw3qbx6ow7b4pmhwa7ocrbbiqwp36sq5yeg6jz2bc\nstorageminer bafk2bzaced4h7noksockro7glnssz2jnmo2rpzd7dvnmfs4p24zx3h6gtx47s\nverifiedregistry bafk2bzacedfel6edzqpe5oujno7fog4i526go4dtcs6vwrdtbpy2xq6htvcg6\neam bafk2bzacedrpm5gbleh4xkyo2jvs7p5g6f34soa6dpv7ashcdgy676snsum6g\nplaceholder bafk2bzacedfvut2myeleyq67fljcrw4kkmn5pb5dpyozovj7jpoez5irnc3ro\nstoragepower bafk2bzacec4ay4crzo73ypmh7o3fjendhbqrxake46bprabw67fvwjz5q6ixq\nsystem bafk2bzacedakk5nofebyup4m7nvx6djksfwhnxzrfuq4oyemhpl4lllaikr64\ncron bafk2bzacedcbtsifegiu432m5tysjzkxkmoczxscb6hqpmrr6img7xzdbbs2g\n")])])])]),e._v(" "),t("li",[t("p",[e._v("When not debugging, it is "),t("strong",[e._v("not recommended")]),e._v(" is set the rust log level to "),t("code",[e._v("trace")]),e._v(" as too much logs may be printed")])]),e._v(" "),t("li",[t("p",[e._v("After upgrading, you can use the command "),t("code",[e._v("./venus state get-actor t01000")]),e._v(" to confirm whether the upgrade is successful")])]),e._v(" "),t("li",[t("p",[e._v("Actor Migration")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("The pre-migration height is 60 epoch before the upgrade epoch of 2683288\nPre-migration start: STARTING pre-migration end: COMPLETED pre-migration\nmigration started: STARTING migration ended: COMPLETED migration\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Configuration changes")]),e._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[e._v("# Added fevm related configuration"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" where the enableEthRPC field is used to control whether to enable ETH RPC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" the default is "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"fevm"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"enableEthRPC"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"ethTxHashMappingLifetimeDays"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"event"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"enableRealTimeFilterAPI"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"enableHistoricFilterAPI"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"filterTTL"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"24h0m0s"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"maxFilters"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"maxFilterResults"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"maxFilterHeightRange"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2880")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"databasePath"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n# Added allowableClockDriftSecs field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" default is "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"parameters"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"allowableClockDriftSecs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n")])])])])]),e._v(" "),t("h2",{attrs:{id:"venus-auth"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-auth"}},[e._v("#")]),e._v(" venus-auth")]),e._v(" "),t("p",[e._v("Feature:")]),e._v(" "),t("p",[e._v("Dependency: none")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[e._v("Check whether the command line can be used correctly")])]),e._v(" "),t("h2",{attrs:{id:"venus-messager"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-messager"}},[e._v("#")]),e._v(" venus-messager")]),e._v(" "),t("p",[e._v("Function:")]),e._v(" "),t("ol",[t("li",[e._v("Added additional interface authentication")])]),e._v(" "),t("p",[e._v("Dependency:")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Observe if messages can be received normally after upgrading")])]),e._v(" "),t("li",[t("p",[e._v("After upgrading, observe whether the message can be on-chained properly")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("ReplacedMsg")]),e._v(" is renamed to "),t("code",[e._v("NonceConflictMsg")])])])]),e._v(" "),t("h2",{attrs:{id:"venus-miner"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-miner"}},[e._v("#")]),e._v(" venus-miner")]),e._v(" "),t("p",[e._v("Feature:")]),e._v(" "),t("p",[e._v("Dependency:")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[e._v("Check if block be produced properly after upgrading")])]),e._v(" "),t("h2",{attrs:{id:"venus-gateway"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-gateway"}},[e._v("#")]),e._v(" venus-gateway")]),e._v(" "),t("p",[e._v("Feature:")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Compile: first "),t("code",[e._v("make dist-clean")]),e._v(" and then "),t("code",[e._v("make")])])]),e._v(" "),t("li",[t("p",[e._v("Check remote wallet after upgrading: "),t("code",[e._v("./venus-gateway wallet list")])])]),e._v(" "),t("li",[t("p",[e._v("Check miners after upgrading: "),t("code",[e._v("./venus-gateway miner list")])])])]),e._v(" "),t("h2",{attrs:{id:"venus-market"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-market"}},[e._v("#")]),e._v(" venus-market")]),e._v(" "),t("p",[e._v("Feature:")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[e._v("Compile: first "),t("code",[e._v("make dist-clean")]),e._v(" and then "),t("code",[e._v("make")])])]),e._v(" "),t("h2",{attrs:{id:"venus-wallet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-wallet"}},[e._v("#")]),e._v(" venus-wallet")]),e._v(" "),t("p",[e._v("Feature:")]),e._v(" "),t("p",[e._v("Precautions:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Need to unlock the wallet after restart")])]),e._v(" "),t("li",[t("p",[e._v("Check if wallet is properly registered to the gateway")])])]),e._v(" "),t("h2",{attrs:{id:"venus-sector-manager"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#venus-sector-manager"}},[e._v("#")]),e._v(" venus-sector-manager")]),e._v(" "),t("p",[e._v("Compile: first "),t("code",[e._v("make dist-clean")]),e._v(" and then "),t("code",[e._v("make")])])])}),[],!1,null,null,null);a.default=r.exports}}]);